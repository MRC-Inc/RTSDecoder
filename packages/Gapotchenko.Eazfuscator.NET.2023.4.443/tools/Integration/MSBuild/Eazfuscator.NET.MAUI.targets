<!--
***********************************************************************************************
Eazfuscator.NET.Xamarin.targets

WARNING:  DO NOT MODIFY this file. Incorrect changes to this file will make it impossible to
          load or build your Eazfuscator.NET projects from the command-line or the IDE.

Copyright (C) 2008-2023 Gapotchenko
***********************************************************************************************
-->

<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <Import Project="Eazfuscator.NET.Cooperation.targets" Condition=" '$(Eazfuscator_NET_Cooperation_Imported)' == '' " />

  <Target Name="_Eazfuscator_NET_MAUI_Trigger" Condition=" '@(MauiXaml)' != '' ">
    <PropertyGroup>
      <_Eazfuscator_NET_TriggeredTargets>$(_Eazfuscator_NET_TriggeredTargets);_Eazfuscator_NET_Cooperation_Maui_FixDebugType</_Eazfuscator_NET_TriggeredTargets>
    </PropertyGroup>	  
  </Target>	
	
  <Target Name="_Eazfuscator_NET_Cooperation_Maui_FixDebugType" Condition=" '$(DebugType)' != 'none' AND Exists('$(IntermediateOutputPath)eazfuscator_cache\$data\DebugSettings.txt') ">
    <ReadLinesFromFile File="$(IntermediateOutputPath)eazfuscator_cache\$data\DebugSettings.txt" >
      <Output TaskParameter="Lines" ItemName="LinesFromFile"/>
    </ReadLinesFromFile>

    <ItemGroup>
      <DebugSettings Include="@(LinesFromFile)" Condition=" $([System.String]::Copy('%(Identity)').Contains('=')) ">
        <Name>$([System.String]::Copy('%(LinesFromFile.Identity)').Split('=')[0].Trim())</Name>
        <Value>$([System.String]::Copy('%(LinesFromFile.Identity)').Split('=')[1].Trim())</Value>
      </DebugSettings>
    </ItemGroup>

    <PropertyGroup Condition=" '@(DebugSettings->WithMetadataValue('Name', 'KeepDebugSymbols')->WithMetadataValue('Value', '1')->Count())' == 0 ">
      <_Eazfuscator_NET_Previous_DebugType>$(DebugType)</_Eazfuscator_NET_Previous_DebugType>
      <DebugType>none</DebugType>
    </PropertyGroup>
  </Target>

  <Target Name="_Eazfuscator_NET_Cooperation_Maui_RollbackDebugType" Condition=" '@(MauiXaml)' != '' AND '$(_Eazfuscator_NET_Previous_DebugType)' != '' " AfterTargets="XamlC">
    <PropertyGroup>
      <DebugType>$(_Eazfuscator_NET_Previous_DebugType)</DebugType>
    </PropertyGroup>
  </Target>

  <PropertyGroup>
    <_Eazfuscator_NET_TriggerTargets>
      $(_Eazfuscator_NET_TriggerTargets);
      _Eazfuscator_NET_MAUI_Trigger
    </_Eazfuscator_NET_TriggerTargets>
  </PropertyGroup>

</Project>
